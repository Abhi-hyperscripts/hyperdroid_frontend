<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png?v=2">
    <title>TenantManager - License Administration</title>
    <script>window.CACHE_VERSION = Date.now();</script>
    <script>document.write('<script src="../../js/sw-version.js?v=' + CACHE_VERSION + '"><\/script>');</script>
    <script src="/js/sw-update.js"></script>
    <script src="/js/pwa-install-prompt.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>document.write('<link rel="stylesheet" href="../../css/theme.css?v=' + CACHE_VERSION + '">');</script>
    <script>document.write('<link rel="stylesheet" href="../../css/styles.css?v=' + CACHE_VERSION + '">');</script>
    <script>document.write('<link rel="stylesheet" href="../../css/landing.css?v=' + CACHE_VERSION + '">');</script>
    <script>document.write('<link rel="stylesheet" href="../../css/login-redesign.css?v=' + CACHE_VERSION + '">');</script>
    <script>document.write('<script src="../../js/theme.js?v=' + CACHE_VERSION + '"><\/script>');</script>
    <style>
        /* TenantManager specific overrides */
        .tm-badge {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%) !important;
        }

        .tm-badge::before {
            background: #f59e0b !important;
        }

        .bento-card.bento-tenants {
            grid-column: span 2;
        }

        .bento-card.bento-tenants .bento-icon {
            background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
        }

        .bento-card.bento-services .bento-icon {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .bento-card.bento-licenses .bento-icon {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .bento-card.bento-verify .bento-icon {
            background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
        }

        .admin-warning {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
            border-radius: 8px;
            font-size: 12px;
            color: #f59e0b;
            margin-top: 16px;
        }

        .admin-warning svg {
            width: 16px;
            height: 16px;
            flex-shrink: 0;
        }
    </style>
</head>
<body class="login-page">
    <!-- Navigation -->
    <nav class="landing-nav auth-nav">
        <a href="../../index.html">
            <img src="../../assets/brand_logo.png" alt="Ragenaizer" class="nav-logo">
        </a>
        <div class="nav-links">
            <a href="../../index.html" class="nav-link">Home</a>
            <a href="../vision.html" class="nav-link">Vision</a>
            <a href="../chat.html" class="nav-link">Chat</a>
            <a href="../drive.html" class="nav-link">Drive</a>
            <a href="../hrms.html" class="nav-link">HRMS</a>
        </div>
        <div class="nav-cta">
            <button class="theme-toggle-btn nav-theme-toggle" id="themeToggle" aria-label="Toggle theme">
                <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="5"/>
                    <line x1="12" y1="1" x2="12" y2="3"/>
                    <line x1="12" y1="21" x2="12" y2="23"/>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
                    <line x1="1" y1="12" x2="3" y2="12"/>
                    <line x1="21" y1="12" x2="23" y2="12"/>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
                </svg>
                <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                </svg>
            </button>
        </div>
    </nav>

    <div class="login-split-container">
        <!-- Left Panel - TenantManager Showcase -->
        <div class="login-showcase-panel">
            <!-- Subtle Background -->
            <div class="showcase-bg">
                <div class="gradient-mesh"></div>
                <div class="noise-overlay"></div>
            </div>

            <!-- Content -->
            <div class="showcase-content">
                <!-- Logo & Tagline -->
                <div class="showcase-header">
                    <img src="../../assets/brand_logo.png" alt="Ragenaizer Logo" class="showcase-logo theme-aware-logo">
                    <div class="tagline-wrapper">
                        <span class="tagline-badge tm-badge">License Administration</span>
                        <h1 class="showcase-headline">TenantManager<br>Control Center.</h1>
                        <p class="showcase-subtext">Manage tenants, configure services, and generate encrypted license tokens for your Ragenaizer ecosystem.</p>
                    </div>
                </div>

                <!-- Bento Grid -->
                <div class="bento-grid">
                    <div class="bento-card bento-tenants">
                        <div class="bento-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                            </svg>
                        </div>
                        <div class="bento-content">
                            <h3>Tenants</h3>
                            <p>Multi-tenant management with SaaS & On-Premise support</p>
                        </div>
                        <div class="bento-stat">
                            <span class="stat-value">âˆž</span>
                            <span class="stat-label">Tenants</span>
                        </div>
                    </div>

                    <div class="bento-card bento-services">
                        <div class="bento-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <rect x="2" y="2" width="20" height="8" rx="2" ry="2"/>
                                <rect x="2" y="14" width="20" height="8" rx="2" ry="2"/>
                                <line x1="6" y1="6" x2="6.01" y2="6"/>
                                <line x1="6" y1="18" x2="6.01" y2="18"/>
                            </svg>
                        </div>
                        <div class="bento-content">
                            <h3>Services</h3>
                            <p>Configure microservices</p>
                        </div>
                    </div>

                    <div class="bento-card bento-licenses">
                        <div class="bento-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                        </div>
                        <div class="bento-content">
                            <h3>Licenses</h3>
                            <p>Generate encrypted tokens</p>
                        </div>
                    </div>

                    <div class="bento-card bento-verify">
                        <div class="bento-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                <polyline points="22 4 12 14.01 9 11.01"/>
                            </svg>
                        </div>
                        <div class="bento-content">
                            <h3>Verify</h3>
                            <p>Validate license tokens</p>
                        </div>
                    </div>

                    <div class="bento-card bento-more">
                        <div class="more-services">
                            <span class="more-item">JWT</span>
                            <span class="more-item">RSA</span>
                            <span class="more-item">AES</span>
                            <span class="more-item">Secure</span>
                        </div>
                    </div>
                </div>

                <!-- Trust Indicators -->
                <div class="trust-bar">
                    <div class="trust-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                        </svg>
                        <span>RSA-256 Encryption</span>
                    </div>
                    <div class="trust-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                        </svg>
                        <span>Authorized Access Only</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Login Form -->
        <div class="login-form-panel">
            <div class="form-panel-inner">
                <!-- Mobile Logo -->
                <div class="mobile-logo">
                    <img src="../../assets/brand_logo.png" alt="Ragenaizer Logo" class="auth-logo-img theme-aware-logo">
                </div>

                <!-- Welcome Section -->
                <div class="login-welcome">
                    <h1 class="welcome-title">Administrator Sign In</h1>
                    <p class="welcome-subtitle">Enter your credentials to access TenantManager.</p>
                </div>

                <!-- Login Form -->
                <div class="login-form-container">
                    <form id="loginForm" class="login-form">
                        <div class="form-group">
                            <label for="email" class="form-label">Email</label>
                            <div class="input-wrapper">
                                <input
                                    type="email"
                                    id="email"
                                    name="email"
                                    class="form-input"
                                    placeholder="admin@tenantmanager.io"
                                    required
                                    autocomplete="email"
                                >
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="label-row">
                                <label for="password" class="form-label">Password</label>
                            </div>
                            <div class="input-wrapper">
                                <input
                                    type="password"
                                    id="password"
                                    name="password"
                                    class="form-input"
                                    placeholder="Enter your password"
                                    required
                                    autocomplete="current-password"
                                >
                                <button type="button" class="toggle-password" id="togglePassword" aria-label="Toggle password visibility">
                                    <svg class="eye-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M1 12S5 4 12 4s11 8 11 8-4 8-11 8S1 12 1 12z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Swipe Button -->
                        <div class="swipe-button-container">
                            <div class="swipe-button-track">
                                <div class="swipe-button-handle" id="swipeHandle">
                                    <span class="handle-text">Swipe to Sign In</span>
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="error-message" id="errorMessage"></div>
                    </form>

                    <!-- Footer -->
                    <div class="login-footer">
                        <div class="admin-warning">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                            </svg>
                            <span>This is a restricted administrative portal. Unauthorized access is prohibited.</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>document.write('<script src="../../js/toast.js?v=' + CACHE_VERSION + '"><\/script>');</script>
    <script>document.write('<script src="../../js/tenant-manager/config.js?v=' + CACHE_VERSION + '"><\/script>');</script>
    <script>document.write('<script src="../../js/tenant-manager/api.js?v=' + CACHE_VERSION + '"><\/script>');</script>
    <script>
        // Check if already logged in
        if (api.isAuthenticated()) {
            window.location.href = 'dashboard.html';
        }

        // Theme toggle
        const themeToggle = document.getElementById('themeToggle');
        themeToggle?.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            localStorage.setItem('theme-mode', newTheme);
        });

        // Toggle password visibility
        const togglePassword = document.getElementById('togglePassword');
        const passwordInput = document.getElementById('password');
        const eyeIcon = togglePassword.querySelector('.eye-icon');

        togglePassword.addEventListener('click', function() {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);

            if (type === 'text') {
                eyeIcon.innerHTML = `
                    <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    <line x1="1" y1="1" x2="23" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></line>
                `;
            } else {
                eyeIcon.innerHTML = `
                    <path d="M1 12S5 4 12 4s11 8 11 8-4 8-11 8S1 12 1 12z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></circle>
                `;
            }
        });

        // Swipe button functionality
        const swipeHandle = document.getElementById('swipeHandle');
        const swipeTrack = swipeHandle?.parentElement;
        let isDragging = false;
        let startX = 0;
        let currentX = 0;

        if (swipeHandle && swipeTrack) {
            const maxSwipe = swipeTrack.offsetWidth - swipeHandle.offsetWidth;

            swipeHandle.addEventListener('mousedown', startDrag);
            swipeHandle.addEventListener('touchstart', startDrag, { passive: true });

            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, { passive: true });

            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);

            function startDrag(e) {
                isDragging = true;
                startX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
                swipeHandle.style.transition = 'none';
            }

            function drag(e) {
                if (!isDragging) return;
                const clientX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                const diff = clientX - startX;
                currentX = Math.max(0, Math.min(diff, maxSwipe));
                swipeHandle.style.transform = `translateX(${currentX}px)`;

                // Update visual feedback
                const progress = currentX / maxSwipe;
                swipeHandle.style.background = `linear-gradient(90deg, var(--brand-primary) ${progress * 100}%, var(--brand-primary) 100%)`;
            }

            function endDrag() {
                if (!isDragging) return;
                isDragging = false;
                swipeHandle.style.transition = 'transform 0.3s ease, background 0.3s ease';

                const maxSwipeUpdated = swipeTrack.offsetWidth - swipeHandle.offsetWidth;
                if (currentX >= maxSwipeUpdated * 0.8) {
                    // Success - trigger login
                    swipeHandle.style.transform = `translateX(${maxSwipeUpdated}px)`;
                    swipeHandle.innerHTML = `
                        <svg class="spinner" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="2" x2="12" y2="6"></line>
                            <line x1="12" y1="18" x2="12" y2="22"></line>
                            <line x1="4.93" y1="4.93" x2="7.76" y2="7.76"></line>
                            <line x1="16.24" y1="16.24" x2="19.07" y2="19.07"></line>
                            <line x1="2" y1="12" x2="6" y2="12"></line>
                            <line x1="18" y1="12" x2="22" y2="12"></line>
                            <line x1="4.93" y1="19.07" x2="7.76" y2="16.24"></line>
                            <line x1="16.24" y1="7.76" x2="19.07" y2="4.93"></line>
                        </svg>
                    `;
                    submitLogin();
                } else {
                    // Reset
                    swipeHandle.style.transform = 'translateX(0)';
                    currentX = 0;
                }
            }
        }

        async function submitLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const errorMessage = document.getElementById('errorMessage');

            if (!email || !password) {
                resetSwipeButton();
                errorMessage.textContent = 'Please enter email and password';
                errorMessage.classList.add('show');
                return;
            }

            errorMessage.classList.remove('show');

            try {
                await api.login(email, password);
                window.location.href = 'dashboard.html';
            } catch (error) {
                resetSwipeButton();
                errorMessage.textContent = error.message;
                errorMessage.classList.add('show');
            }
        }

        function resetSwipeButton() {
            if (swipeHandle) {
                swipeHandle.style.transform = 'translateX(0)';
                swipeHandle.innerHTML = `
                    <span class="handle-text">Swipe to Sign In</span>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                        <path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                `;
                currentX = 0;
            }
        }

        // Also handle form submit (Enter key)
        document.getElementById('loginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            submitLogin();
        });
    </script>
</body>
</html>
