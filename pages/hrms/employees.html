<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Management - HRMS - HyperDroid</title>
    <script>window.CACHE_VERSION = Date.now();</script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script>document.write('<link rel="stylesheet" href="../../css/styles.css?v=' + CACHE_VERSION + '">');</script>
    <script>document.write('<link rel="stylesheet" href="../../css/hrms.css?v=' + CACHE_VERSION + '">');</script>
</head>
<body class="dashboard">
    <nav class="navbar">
        <div class="navbar-brand">
            <a href="../home.html">
                <img src="../../assets/logo-svg.svg" alt="HyperDroid Logo" class="navbar-logo">
            </a>
        </div>
        <div class="navbar-menu"></div>
    </nav>

    <div class="hrms-container">
        <div class="hrms-header">
            <div>
                <div class="breadcrumb-nav">
                    <a href="dashboard.html">HRMS</a>
                    <span>/</span>
                    <span>Employees</span>
                </div>
                <h1>Employee Management</h1>
                <p>Manage employee profiles and records</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="openCreateEmployeeModal()" id="createEmployeeBtn" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    Add Employee
                </button>
            </div>
        </div>

        <!-- Filters -->
        <div class="filters-bar">
            <div class="search-input-wrapper">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                </svg>
                <input type="text" class="search-input" id="searchInput" placeholder="Search employees..." oninput="filterEmployees()">
            </div>
            <select class="filter-select" id="departmentFilter" onchange="filterEmployees()">
                <option value="">All Departments</option>
            </select>
            <select class="filter-select" id="officeFilter" onchange="filterEmployees()">
                <option value="">All Offices</option>
            </select>
            <select class="filter-select" id="statusFilter" onchange="filterEmployees()">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="on_notice">On Notice</option>
                <option value="terminated">Terminated</option>
            </select>
        </div>

        <!-- Employee Stats -->
        <div class="stats-row">
            <div class="stat-mini">
                <span class="stat-mini-value" id="totalCount">-</span>
                <span class="stat-mini-label">Total</span>
            </div>
            <div class="stat-mini active">
                <span class="stat-mini-value" id="activeCount">-</span>
                <span class="stat-mini-label">Active</span>
            </div>
            <div class="stat-mini warning">
                <span class="stat-mini-value" id="probationCount">-</span>
                <span class="stat-mini-label">On Probation</span>
            </div>
            <div class="stat-mini danger">
                <span class="stat-mini-value" id="exitCount">-</span>
                <span class="stat-mini-label">Exits This Month</span>
            </div>
        </div>

        <!-- Employees Table -->
        <div class="data-table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Employee</th>
                        <th>Department</th>
                        <th>Designation</th>
                        <th>Office</th>
                        <th>Joining Date</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="employeesTableBody">
                    <tr>
                        <td colspan="7">
                            <div class="loading-spinner">
                                <div class="spinner"></div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Create/Edit Employee Modal -->
    <div class="modal" id="employeeModal">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="employeeModalTitle">Add Employee</h3>
                    <button class="close-btn" onclick="closeModal('employeeModal')">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="employeeForm">
                        <input type="hidden" id="employeeId">

                        <!-- User Selection (for new employees) -->
                        <div class="form-section" id="userSelectionSection">
                            <h4>Select User Account</h4>
                            <div class="form-group">
                                <label>User Account <span class="required">*</span></label>
                                <select id="userSelect" required>
                                    <option value="">Select a user...</option>
                                </select>
                                <small class="form-text">Only users without employee profiles are shown</small>
                            </div>
                        </div>

                        <!-- Personal Information -->
                        <div class="form-section">
                            <h4>Personal Information</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Employee Code <span class="required">*</span></label>
                                    <input type="text" id="employeeCode" required placeholder="EMP001">
                                </div>
                                <div class="form-group">
                                    <label>First Name <span class="required">*</span></label>
                                    <input type="text" id="firstName" required placeholder="John">
                                </div>
                                <div class="form-group">
                                    <label>Last Name <span class="required">*</span></label>
                                    <input type="text" id="lastName" required placeholder="Doe">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Work Email <span class="required">*</span></label>
                                    <input type="email" id="workEmail" required placeholder="john.doe@company.com">
                                </div>
                                <div class="form-group">
                                    <label>Work Phone</label>
                                    <input type="tel" id="workPhone" placeholder="+91-9876543210">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Date of Birth</label>
                                    <input type="date" id="dateOfBirth">
                                </div>
                                <div class="form-group">
                                    <label>Gender</label>
                                    <select id="gender">
                                        <option value="">Select...</option>
                                        <option value="male">Male</option>
                                        <option value="female">Female</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Employment Details -->
                        <div class="form-section">
                            <h4>Employment Details</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Office <span class="required">*</span></label>
                                    <select id="officeId" required onchange="updateForOfficeChange()">
                                        <option value="">Select office...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Department <span class="required">*</span></label>
                                    <select id="departmentId" required onchange="onDepartmentChange()">
                                        <option value="">Select office first...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Designation <span class="required">*</span></label>
                                    <select id="designationId" required>
                                        <option value="">Select department first...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Shift</label>
                                    <select id="shiftId">
                                        <option value="">Select office first...</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Reporting Manager</label>
                                    <select id="reportingManagerId">
                                        <option value="">None</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Employment Type <span class="required">*</span></label>
                                    <select id="employmentType" required>
                                        <option value="full_time">Full Time</option>
                                        <option value="part_time">Part Time</option>
                                        <option value="contract">Contract</option>
                                        <option value="intern">Intern</option>
                                        <option value="consultant">Consultant</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Date of Joining <span class="required">*</span></label>
                                    <input type="date" id="dateOfJoining" required>
                                </div>
                                <div class="form-group">
                                    <label>Probation End Date</label>
                                    <input type="date" id="probationEndDate">
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('employeeModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="saveEmployee()">Save Employee</button>
                </div>
            </div>
        </div>
    </div>

    <!-- View Employee Modal -->
    <div class="modal" id="viewEmployeeModal">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Employee Details</h3>
                    <button class="close-btn" onclick="closeModal('viewEmployeeModal')">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                            <line x1="18" y1="6" x2="6" y2="18"/>
                            <line x1="6" y1="6" x2="18" y2="18"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" id="viewEmployeeContent">
                    <div class="loading-spinner">
                        <div class="spinner"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal('viewEmployeeModal')">Close</button>
                    <button class="btn btn-primary" onclick="editFromView()" id="editFromViewBtn">Edit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script>
        document.write('<script src="../../js/config.js?v=' + CACHE_VERSION + '"><\/script>');
        document.write('<script src="../../js/api.js?v=' + CACHE_VERSION + '"><\/script>');
        document.write('<script src="../../js/navigation.js?v=' + CACHE_VERSION + '"><\/script>');
        document.write('<script src="../../js/hrms/employees.js?v=' + CACHE_VERSION + '"><\/script>');
    </script>
</body>
</html>
